<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Submit a Testimonial — RM Connect</title>
  <meta name="description" content="Submit a testimonial for RM Connect — automation, integrations, and workflow design services." />
  <link rel="stylesheet" href="./styles/tailwind.min.css">
  <style>
    :root { --brand-navy:#0A1B2A; --brand-accent:#FF6A00; }
    body { margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial; }
    .bg-accent { background-color: var(--brand-accent); }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

<main class="max-w-2xl mx-auto px-6 py-12">
  <h1 class="text-3xl font-bold mb-6">Submit a Testimonial</h1>

  <form id="testimonial-form" class="bg-white p-6 rounded-xl shadow space-y-4" novalidate>
    <label class="block">
      <span class="text-sm font-medium">Your name</span>
      <input name="name" required class="w-full mt-1 p-2 border rounded" />
    </label>

    <label class="block">
      <span class="text-sm font-medium">Company (optional)</span>
      <input name="company" class="w-full mt-1 p-2 border rounded" />
    </label>

    <label class="block">
      <span class="text-sm font-medium">Testimonial</span>
      <textarea name="message" rows="5" required class="w-full mt-1 p-2 border rounded"></textarea>
    </label>

    <!-- Honeypot anti-spam -->
    <div style="display:none">
      <label>Leave empty: <input name="hp"></label>
    </div>

    <div class="flex items-center gap-3">
      <button id="submitBtn" type="submit" class="px-4 py-2 bg-accent text-white rounded font-medium">Submit</button>
      <span id="form-status" class="text-sm text-gray-600" role="status" aria-live="polite"></span>
    </div>
  </form>
</main>

<script>
/*
 Note: update WORKER_BASE to your worker endpoint (kept as your original variable in case you want to use it)
*/
const WORKER_BASE = "https://morningside-decapsso.mukechiwarichard.workers.dev";   // <-- update this

document.getElementById('testimonial-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const statusEl = document.getElementById('form-status');
  const submitBtn = document.getElementById('submitBtn');
  const data = new FormData(e.target);

  if (data.get('hp')) return; // bot detected

  const payload = {
    name: data.get('name'),
    company: data.get('company'),
    message: data.get('message')
  };

  statusEl.textContent = 'Sending...';
  submitBtn.disabled = true;

  try {
    const res = await fetch(`${WORKER_BASE}/submit`, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });

    if (res.ok) {
      statusEl.textContent = 'Thanks — submitted!';
      e.target.reset();
    } else {
      const txt = await res.text();
      statusEl.textContent = txt || 'Error';
    }

  } catch (err) {
    statusEl.textContent = 'Network error';
  } finally {
    submitBtn.disabled = false;
  }
});
</script>

</body>
</html>
